{"version":3,"file":null,"sources":["../src/jc.js","../src/config.js","../src/coin.js","../src/blink.js","../src/utils.js","../src/fly.js"],"sourcesContent":["\nconst inModule = typeof require === 'function';\nconst inBrowser = typeof window !== 'undefined';\nexport const JC = inModule && inBrowser ?\nrequire('jcc2d/build/jcc2d.light.js') : inBrowser ?\nwindow.JC :\n{};\n","'use strict';\n\nconst CONFIG = {\n  GLOBAL_WEIGHT: 0.25,\n  MAX_SLOPE: 20,\n  TIMELINE: {\n    stars: [0.08, 0.08, 0.28, 0.52, 0.12],\n    blinks: [0.3, 0.05, 0.15],\n  },\n};\n\nexport {CONFIG};\n","'use strict';\n/* eslint no-bitwise: 0 */\n\nimport {JC} from './jc';\nconst FRONT = new JC.Point(0, 0, 10);\nimport {CONFIG} from './config';\n\n/**\n *\n * @param {Object} options\n */\nfunction Coin(options) {\n  const texture = new JC.Texture(options.texture);\n  this.doc = new JC.Sprite({\n    texture,\n  });\n  this.doc.scale = 0;\n  if (options.pivot) {\n    this.doc.pivotX = options.pivot.x;\n    this.doc.pivotY = options.pivot.y;\n  } else {\n    if (texture.loaded) {\n      this._center();\n    } else {\n      texture.on('load', () => {\n        this._center();\n      });\n    }\n  }\n}\n\nCoin.prototype._center = function() {\n  this.doc.pivotX = this.doc.width >> 1;\n  this.doc.pivotY = this.doc.height >> 1;\n};\n\nCoin.prototype.fly = function({start, end, wait, duration}) {\n  if (this.alive) return;\n  const This = this;\n  const sp = new JC.Point(start.x, start.y).add(this.offset);\n  const ep = new JC.Point(end.x, end.y);\n  const cp = this._findCP(sp, ep);\n  const path = new JC.BezierCurve([sp, cp, ep]);\n  const timeline = CONFIG.TIMELINE.stars;\n\n  this.alive = true;\n  this.doc.runners({\n    runners: [\n      {\n        from: {scale: 0, x: sp.x, y: sp.y},\n        to: {scale: 1.2, x: sp.x, y: sp.y},\n        duration: timeline[0] * duration,\n      },\n      {\n        to: {scale: 1},\n        duration: timeline[1] * duration,\n      },\n      {\n        path,\n        wait: timeline[2] * duration,\n        duration: timeline[3] * duration,\n        ease: JC.Tween.Back.In,\n      },\n      {\n        to: {scale: 0},\n        duration: timeline[4] * duration,\n        ease: JC.Tween.Linear.None,\n      },\n    ],\n    wait,\n    onCompelete() {\n      This.alive = false;\n    },\n  }, true);\n};\n\nCoin.prototype._findCP = function(sp, ep) {\n  const center = new JC.Point().addVectors(ep, sp).divideScalar(2);\n  const direction = new JC.Point().subVectors(ep, sp);\n  const symbolX = ep.x > sp.x ? -1 : 1;\n  const symbolY = ep.y > sp.y ? 1 : -1;\n  const symbol = symbolX * symbolY;\n  const perpendicular = new JC.Point()\n  .crossVectors(FRONT, direction)\n  .normalize();\n\n  const length = direction.length();\n  const rawSlope = direction.y !== 0 ?\n  Math.abs(direction.x / direction.y) :\n  CONFIG.MAX_SLOPE;\n  const slope = Math.sqrt(Math.min(CONFIG.MAX_SLOPE, Math.abs(rawSlope)));\n  const weight = slope * length;\n\n  const scalar = perpendicular\n  .multiplyScalar(symbol * weight * CONFIG.GLOBAL_WEIGHT);\n\n  return center.add(scalar);\n};\n\nexport {Coin};\n","'use strict';\n\nimport {JC} from './jc';\nimport {CONFIG} from './config';\n\n/**\n *\n * @param {Object} options\n */\nfunction Cricle(options) {\n  options = options || {};\n  this.radius = options.radius || 8;\n  this.color = options.color || '#FFD44F';\n}\n\nCricle.prototype.render = function(ctx) {\n  ctx.beginPath();\n  ctx.fillStyle = this.color;\n  ctx.arc(0, 0, this.radius, 0, Math.PI * 2, true);\n  ctx.closePath();\n  ctx.fill();\n};\n\n/**\n *\n * @param {Object} options\n */\nfunction Blink(options) {\n  options = options || {};\n  this.doc = new JC.Graphics(new Cricle({\n    radius: options.radius,\n    color: options.color,\n  }));\n  this.doc.scale = 0;\n}\n\nBlink.prototype.boom = function({endBase, end, wait, duration}) {\n  if (this.alive) return;\n  const This = this;\n  const sx = endBase.x;\n  const sy = endBase.y;\n  const x = end.x;\n  const y = end.y;\n  const ex = sx + x;\n  const ey = sy + y;\n  const timeline = CONFIG.TIMELINE.blinks;\n\n  this.alive = true;\n  this.doc.runners({\n    runners: [\n      {\n        from: {x: sx, y: sy, scale: 0},\n        to: {x: ex, y: ey, scale: 1},\n        duration: timeline[0] * duration,\n        ease: JC.Tween.Linear.None,\n      },\n      {\n        to: {x: sx + x * 1.1, y: sy + y * 1.1},\n        duration: timeline[1] * duration,\n        ease: JC.Tween.Linear.None,\n      },\n      {\n        to: {scale: 0},\n        duration: timeline[2] * duration,\n        ease: JC.Tween.Linear.None,\n      },\n    ],\n    wait,\n    onCompelete() {\n      This.alive = false;\n    },\n  }, true);\n};\n\nexport {Blink};\n","\n/**\n * Utils 工具箱\n *\n * @namespace JC.Utils\n */\nexport const Utils = {\n  merge: function(master, branch) {\n    if (!branch) return master;\n    for (const key in branch) {\n      if (branch[key] !== undefined) {\n        master[key] = branch[key];\n      }\n    }\n    return master;\n  },\n};\n","'use strict';\n\nimport {Coin} from './coin';\nimport {Blink} from './blink';\nimport {Utils} from './utils';\nimport {JC} from './jc';\n\nconst PMARK = 'cp';\nconst OFFSETS = [\n  {x: -8, y: -8},\n  {x: 14, y: -2},\n  {x: -5, y: 11},\n];\nconst STORE = {\n  aliveCoins: [],\n  idelCoins: [],\n  aliveBlinks: [],\n  idelBlinks: [],\n  criclrPoint: {},\n};\nconst STAGE_OPTION = {\n  dom: 'flycoins-stage',\n  interactive: false,\n  enableFPS: false,\n  width: 320,\n  height: 320,\n};\n\n/**\n *\n * @param {Object} options 配置\n */\nfunction FlyCoins(options) {\n  options = options || {};\n  this.stageOpts = Utils.merge(STAGE_OPTION, options.stage);\n  this.coinsOpts = options.coins || {};\n  this.blinksOpts = options.blinks || {};\n  this.end = options.end || {};\n  this.duration = options.duration || 1000;\n  this.init();\n}\n\nFlyCoins.prototype.init = function() {\n  this.stage = new JC.Stage(this.stageOpts);\n  this.coins = new JC.Container();\n  this.blinks = new JC.Container();\n  this.stage.adds(this.blinks, this.coins);\n};\n\nFlyCoins.prototype._getTarget = function(count, range) {\n  if (range <= 0 || count <= 0) {\n    console.error('you must insure count and range > 0');\n  }\n  const mark = PMARK + count + 'N' + range;\n  const target = STORE.criclrPoint[mark] = STORE.criclrPoint[mark] || [];\n  if (target.length === count) return target;\n  for (let i = 0; i < count; i++) {\n    const rad = Math.PI * 2 * i / count;\n    const p = new JC.Point(Math.cos(rad) * range, Math.sin(rad) * range);\n    target.push(p);\n  }\n  return target;\n};\n\nFlyCoins.prototype._checkAlive = function(alive, idel) {\n  for (let i = alive.length - 1; i >= 0; i--) {\n    const coin = alive[i];\n    if (!coin.alive) {\n      idel.push(alive.splice(i, 1)[0]);\n    }\n  }\n};\n\nFlyCoins.prototype._shipCoins = function(coins) {\n  this._checkAlive(STORE.aliveCoins, STORE.idelCoins);\n  const offsets = coins.offsets || OFFSETS;\n  const count = offsets.length;\n  const num = count - STORE.idelCoins.length;\n  if (num > 0) {\n    for (let i = 0; i < num; i++) {\n      STORE.idelCoins.push(new Coin(coins));\n    }\n  }\n  const emitCoins = STORE.idelCoins.splice(0, count);\n  offsets.forEach((it, idx) => {\n    const coin = emitCoins[idx];\n    coin.offset = new JC.Point(it.x, it.y);\n    this.coins.adds(coin.doc);\n  });\n  return emitCoins;\n};\n\nFlyCoins.prototype._emitCoins = function(coinsobj, {end, duration, start}) {\n  end = end || this.end;\n  duration = duration || this.duration;\n  const last = coinsobj.length - 1;\n  for (let i = last; i >= 0; i--) {\n    const coin = coinsobj[i];\n    coin.fly({\n      start,\n      end,\n      wait: (last - i) * duration * 0.1,\n      duration,\n    });\n    STORE.aliveCoins.push(coin);\n  }\n};\n\nFlyCoins.prototype.flying = function({coins, blinks, start, end}) {\n  const cCoins = Utils.merge(this.coinsOpts, coins);\n  const cBlinks = Utils.merge(this.blinksOpts, blinks);\n\n  const coinsobj = this._shipCoins(cCoins);\n  this._emitCoins(coinsobj, {\n    start,\n    end,\n  });\n\n  this._shipAndEmitBlinks(cBlinks, end);\n};\n\nFlyCoins.prototype._shipAndEmitBlinks = function(\n  {count, range, color, radius},\n  endBase\n) {\n  this._checkAlive(STORE.aliveBlinks, STORE.idelBlinks);\n\n  const targetPoints = this._getTarget(count, range);\n\n  const num = count - STORE.idelBlinks.length;\n  if (num > 0) {\n    for (let i = 0; i < num; i++) {\n      STORE.idelBlinks.push(new Blink({\n        color,\n        radius,\n      }));\n    }\n  }\n  const emitBlinks = STORE.idelBlinks.splice(0, count);\n  // TODO: add update blink color and radius\n\n  endBase = endBase || this.end;\n  const duration = this.duration;\n  const length = emitBlinks.length;\n  for (let i = 0; i < length; i++) {\n    const blink = emitBlinks[i];\n    const end = targetPoints[i];\n    this.blinks.adds(blink.doc);\n    blink.boom({\n      endBase,\n      end,\n      wait: duration,\n      duration,\n    });\n    STORE.aliveBlinks.push(blink);\n  }\n};\n\nFlyCoins.prototype.start = function() {\n  this.stage.startEngine();\n};\n\nFlyCoins.prototype.stop = function() {\n  this.stage.stopEngine();\n};\n\nexport {FlyCoins};\n"],"names":["inModule","require","inBrowser","window","JC","CONFIG","FRONT","Point","Coin","options","texture","Texture","doc","Sprite","scale","pivot","pivotX","x","pivotY","y","loaded","_center","on","prototype","width","height","fly","start","end","wait","duration","alive","This","sp","add","offset","ep","cp","_findCP","path","BezierCurve","timeline","TIMELINE","stars","runners","Tween","Back","In","Linear","None","center","addVectors","divideScalar","direction","subVectors","symbolX","symbolY","symbol","perpendicular","crossVectors","normalize","length","rawSlope","Math","abs","MAX_SLOPE","slope","sqrt","min","weight","scalar","multiplyScalar","GLOBAL_WEIGHT","Cricle","radius","color","render","ctx","beginPath","fillStyle","arc","PI","closePath","fill","Blink","Graphics","boom","endBase","sx","sy","ex","ey","blinks","Utils","master","branch","key","undefined","PMARK","OFFSETS","STORE","STAGE_OPTION","FlyCoins","stageOpts","merge","stage","coinsOpts","coins","blinksOpts","init","Stage","Container","adds","_getTarget","count","range","error","mark","target","criclrPoint","i","rad","p","cos","sin","push","_checkAlive","idel","coin","splice","_shipCoins","aliveCoins","idelCoins","offsets","num","emitCoins","forEach","it","idx","_emitCoins","coinsobj","last","flying","cCoins","cBlinks","_shipAndEmitBlinks","aliveBlinks","idelBlinks","targetPoints","emitBlinks","blink","startEngine","stop","stopEngine"],"mappings":"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"}